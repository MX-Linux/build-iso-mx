#------------------------------------------------------------------
# file: /boot/grub/grub.cfg for the Live version of %DISTRO_NAME%
# Arch Linux live ISO configuration
#------------------------------------------------------------------

#echo a space to get console working on some older machines
echo " "

# Load defaults and common config
if [ -s $prefix/config/defaults.cfg ]; then
	source $prefix/config/defaults.cfg
fi

# Load graphics modules and fonts for theme (continue on error)
insmod all_video || true
insmod gfxterm || true
insmod gfxterm_background || true
insmod gfxterm_menu || true
insmod jpeg || true
insmod png || true

# Load font for theme
if [ -f $prefix/fonts/unicode.pf2 ]; then
	loadfont $prefix/fonts/unicode.pf2
elif [ -f $prefix/unicode.pf2 ]; then
	loadfont $prefix/unicode.pf2
fi

# Set graphics mode
set gfxmode=1024x768
set gfxpayload="1440x960;1440x900;1368x912;1366x768;1280x800;1280x720;1280x1024;1200x800;1024x768;auto"

# Enable graphical terminal
if terminal_output gfxterm ; then
	true
fi

# Load theme if available
if [ -f $prefix/theme/uefi.txt ]; then
	set theme=$prefix/theme/uefi.txt
	export theme
fi

set default=0
set timeout=30

menuentry " %FULL_DISTRO_NAME_SPACE% (%RELEASE_DATE%)" --id=linux {
	search --no-floppy --set=root --label "%ISO_LABEL%"
	linux  /arch/boot/%ARCH%/vmlinuz-linux archisobasedir=arch archisolabel=%ISO_LABEL% copytoram=0 quiet splash
	initrd /arch/boot/%ARCH%/archiso.img
}

menuentry " %FULL_DISTRO_NAME_SPACE% (Copy to RAM)" --id=copytoram {
	search --no-floppy --set=root --label "%ISO_LABEL%"
	linux  /arch/boot/%ARCH%/vmlinuz-linux archisobasedir=arch archisolabel=%ISO_LABEL% copytoram quiet splash
	initrd /arch/boot/%ARCH%/archiso.img
}

if [ -f $prefix/theme/help.txt ]; then
	menuentry " "$"Help" --hotkey=H {
		cat $prefix/theme/help.txt
		echo -n $"Press <Enter> to continue"" "
		read xxx_help
	}
fi

menuentry " "$"Reboot" --id=reboot {
	reboot
}

menuentry " "$"Shutdown" --id=shutdown {
	halt
}
